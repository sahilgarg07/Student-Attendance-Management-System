{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userLogin } from '../Store/Slices/userSlice';\nimport { personLogin } from '../Store/Slices/personSlice';\nimport axiosInstance from \"../axios\";\nimport { json, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nexport const useSignup = () => {\n  _s();\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(null);\n  const dispatch = useDispatch();\n  const signup = async formData => {\n    const {\n      name,\n      email,\n      username: rollNumber\n    } = formData;\n    setIsLoading(true);\n    setError(null);\n    // console.log(rollNumber)\n    try {\n      console.log(\"heelo\");\n      console.log(formData);\n      const response = await axiosInstance.post('Auth/register', formData);\n      console.log(response);\n      await axiosInstance.post('/Home/student', {\n        name,\n        email,\n        rollNumber\n      });\n      // if(response.data.msg==='Username already taken'){\n      //     alert(response.data.msg);\n      //     setError()\n      // }\n      console.log('Signup response:', response.data);\n      localStorage.setItem('access_token', response.data['token']['access']);\n      localStorage.setItem('refresh_token', response.data['token']['refresh']);\n      axiosInstance.defaults.headers['Authorization'] = 'Bearer ' + localStorage.getItem('access_token');\n      console.log('Bearer ' + localStorage.getItem('access_token'));\n      const response1 = await axiosInstance.get('Auth/profile');\n      console.log(response1.data);\n      dispatch(personLogin(response1.data));\n    } catch (error) {\n      console.log('Register Error', error);\n      setError(error);\n    }\n    setIsLoading(false);\n    // const response = await fetch('/api/user/signup',{\n    //     method: 'POST',\n    //     headers: { 'Content-Type': 'application/json'},\n    //     body: JSON.stringify({email,password})\n    // })\n    // const json=await response.json();\n    // // console.log(json,5456955);\n    // if(!response.ok){\n    //     setIsLoading(false);\n    //     setError(json.error);\n    // }\n    // if(response.ok){\n    //     const dataresponse = await fetch('/api/data/addperson',{\n    //         method: 'POST',\n    //         headers: { 'Content-Type': 'application/json',\n    //         'Authorization': `Bearer ${json.email} ${json.token}`},\n    //         body: JSON.stringify({name,email})\n    //     })\n    //\n    //     const datajson=await dataresponse.json();\n    //     // console.log(datajson,5698);\n    //     if(!dataresponse.ok){\n    //         setIsLoading(false);\n    //         setError(datajson.error);\n    //     }\n    //     if(dataresponse.ok){\n    //         localStorage.setItem('user', JSON.stringify(json));\n    //         setIsLoading(false);\n    //         dispatch(userLogin(json));\n    //         dispatch(personLogin(datajson));\n    //     }\n    // }\n  };\n\n  return {\n    signup,\n    isLoading,\n    error\n  };\n};\n_s(useSignup, \"I9+v+L4feSIzTJ6DnnQFLFYbO6c=\", false, function () {\n  return [useDispatch];\n});","map":{"version":3,"names":["useState","useDispatch","userLogin","personLogin","axiosInstance","json","useNavigate","axios","useSignup","_s","error","setError","isLoading","setIsLoading","dispatch","signup","formData","name","email","username","rollNumber","console","log","response","post","data","localStorage","setItem","defaults","headers","getItem","response1","get"],"sources":["/home/sahil/Student-Record-Management-System/frontend/src/hooks/useSignup.js"],"sourcesContent":["import { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userLogin} from '../Store/Slices/userSlice';\nimport { personLogin} from '../Store/Slices/personSlice';\nimport axiosInstance from \"../axios\";\nimport {json, useNavigate} from \"react-router-dom\";\nimport axios from \"axios\";\n\nexport const useSignup=()=>{\n    const [error,setError]=useState(null);\n    const [isLoading,setIsLoading]=useState(null);\n    const dispatch=useDispatch();\n    \n    \n    const signup=async (formData)=>{\n        const {name,email,username:rollNumber}=formData;\n        setIsLoading(true);\n        setError(null);\n        // console.log(rollNumber)\n        try {\n            console.log(\"heelo\");\n            console.log(formData);\n            const response = await axiosInstance.post('Auth/register', formData);\n            console.log(response);\n            await axiosInstance.post('/Home/student',{name,email,rollNumber});\n            // if(response.data.msg==='Username already taken'){\n            //     alert(response.data.msg);\n            //     setError()\n            // }\n            console.log('Signup response:', response.data);\n            localStorage.setItem('access_token',response.data['token']['access']);\n            localStorage.setItem('refresh_token', response.data['token']['refresh']);\n            axiosInstance.defaults.headers['Authorization'] = 'Bearer '+ localStorage.getItem('access_token');\n            console.log('Bearer '+ localStorage.getItem('access_token'));\n            const response1 = await axiosInstance.get('Auth/profile')\n            console.log(response1.data)\n            dispatch(personLogin(response1.data));\n        }catch (error) {\n            console.log('Register Error', error);\n            setError(error);\n        }\n        setIsLoading(false);\n        // const response = await fetch('/api/user/signup',{\n        //     method: 'POST',\n        //     headers: { 'Content-Type': 'application/json'},\n        //     body: JSON.stringify({email,password})\n        // })\n        // const json=await response.json();\n        // // console.log(json,5456955);\n        // if(!response.ok){\n        //     setIsLoading(false);\n        //     setError(json.error);\n        // }\n        // if(response.ok){\n        //     const dataresponse = await fetch('/api/data/addperson',{\n        //         method: 'POST',\n        //         headers: { 'Content-Type': 'application/json',\n        //         'Authorization': `Bearer ${json.email} ${json.token}`},\n        //         body: JSON.stringify({name,email})\n        //     })\n        //\n        //     const datajson=await dataresponse.json();\n        //     // console.log(datajson,5698);\n        //     if(!dataresponse.ok){\n        //         setIsLoading(false);\n        //         setError(datajson.error);\n        //     }\n        //     if(dataresponse.ok){\n        //         localStorage.setItem('user', JSON.stringify(json));\n        //         setIsLoading(false);\n        //         dispatch(userLogin(json));\n        //         dispatch(personLogin(datajson));\n        //     }\n        // }\n    }\n    return {signup,isLoading,error};\n}"],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,SAAS,QAAO,2BAA2B;AACpD,SAASC,WAAW,QAAO,6BAA6B;AACxD,OAAOC,aAAa,MAAM,UAAU;AACpC,SAAQC,IAAI,EAAEC,WAAW,QAAO,kBAAkB;AAClD,OAAOC,KAAK,MAAM,OAAO;AAEzB,OAAO,MAAMC,SAAS,GAACA,CAAA,KAAI;EAAAC,EAAA;EACvB,MAAM,CAACC,KAAK,EAACC,QAAQ,CAAC,GAACX,QAAQ,CAAC,IAAI,CAAC;EACrC,MAAM,CAACY,SAAS,EAACC,YAAY,CAAC,GAACb,QAAQ,CAAC,IAAI,CAAC;EAC7C,MAAMc,QAAQ,GAACb,WAAW,CAAC,CAAC;EAG5B,MAAMc,MAAM,GAAC,MAAOC,QAAQ,IAAG;IAC3B,MAAM;MAACC,IAAI;MAACC,KAAK;MAACC,QAAQ,EAACC;IAAU,CAAC,GAACJ,QAAQ;IAC/CH,YAAY,CAAC,IAAI,CAAC;IAClBF,QAAQ,CAAC,IAAI,CAAC;IACd;IACA,IAAI;MACAU,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;MACpBD,OAAO,CAACC,GAAG,CAACN,QAAQ,CAAC;MACrB,MAAMO,QAAQ,GAAG,MAAMnB,aAAa,CAACoB,IAAI,CAAC,eAAe,EAAER,QAAQ,CAAC;MACpEK,OAAO,CAACC,GAAG,CAACC,QAAQ,CAAC;MACrB,MAAMnB,aAAa,CAACoB,IAAI,CAAC,eAAe,EAAC;QAACP,IAAI;QAACC,KAAK;QAACE;MAAU,CAAC,CAAC;MACjE;MACA;MACA;MACA;MACAC,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEC,QAAQ,CAACE,IAAI,CAAC;MAC9CC,YAAY,CAACC,OAAO,CAAC,cAAc,EAACJ,QAAQ,CAACE,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC;MACrEC,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEJ,QAAQ,CAACE,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC;MACxErB,aAAa,CAACwB,QAAQ,CAACC,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,GAAEH,YAAY,CAACI,OAAO,CAAC,cAAc,CAAC;MACjGT,OAAO,CAACC,GAAG,CAAC,SAAS,GAAEI,YAAY,CAACI,OAAO,CAAC,cAAc,CAAC,CAAC;MAC5D,MAAMC,SAAS,GAAG,MAAM3B,aAAa,CAAC4B,GAAG,CAAC,cAAc,CAAC;MACzDX,OAAO,CAACC,GAAG,CAACS,SAAS,CAACN,IAAI,CAAC;MAC3BX,QAAQ,CAACX,WAAW,CAAC4B,SAAS,CAACN,IAAI,CAAC,CAAC;IACzC,CAAC,QAAOf,KAAK,EAAE;MACXW,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEZ,KAAK,CAAC;MACpCC,QAAQ,CAACD,KAAK,CAAC;IACnB;IACAG,YAAY,CAAC,KAAK,CAAC;IACnB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACJ,CAAC;;EACD,OAAO;IAACE,MAAM;IAACH,SAAS;IAACF;EAAK,CAAC;AACnC,CAAC;AAAAD,EAAA,CApEYD,SAAS;EAAA,QAGHP,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}