{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userLogin } from '../Store/Slices/userSlice';\nimport { personLogin } from '../Store/Slices/personSlice';\nimport axiosInstance from \"../axios\";\nexport const useLogin = () => {\n  _s();\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(null);\n  const dispatch = useDispatch();\n  const login = async formData => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await axiosInstance.post('Auth/login', formData).catch(function (error) {\n        console.log(response);\n        if (error.response) {\n          // The request was made and the server responded with a status code\n          // that falls out of the range of 2xx\n          console.log(error.response.data);\n          console.log(error.response.status);\n          console.log(error.response.headers);\n        } else if (error.request) {\n          // The request was made but no response was received\n          // `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n          // http.ClientRequest in node.js\n          console.log(error.request);\n        } else {\n          // Something happened in setting up the request that triggered an Error\n          console.log('Error', error.message);\n        }\n        setError(true);\n      }); // Replace 'Auth/login' with your desired login endpoint\n      console.log('Login response:', response.data['token']['access']);\n      localStorage.setItem('access_token', response.data['token']['access']);\n      localStorage.setItem('refresh_token', response.data['token']['refresh']);\n      axiosInstance.defaults.headers['Authorization'] = 'Bearer ' + localStorage.getItem('access_token');\n\n      // dispatch(userLogin(response.data));\n      const response1 = await axiosInstance.get('Auth/profile');\n      console.log(response1);\n      // console.log(response1.data)\n      dispatch(personLogin(response1.data));\n    } catch (error) {\n      alert(error);\n      setError(error);\n    }\n    setIsLoading(false);\n\n    //     if(!dataresponse.ok){\n    //         setIsLoading(false);\n    //\n    //     }\n    //     if(dataresponse.ok){\n    //     localStorage.setItem('user', JSON.stringify(json));\n\n    //     dispatch(userLogin(json));\n    //     dispatch(personLogin(datajson));\n    //     }\n    // }\n  };\n\n  return {\n    login,\n    isLoading,\n    error\n  };\n};\n_s(useLogin, \"I9+v+L4feSIzTJ6DnnQFLFYbO6c=\", false, function () {\n  return [useDispatch];\n});","map":{"version":3,"names":["useState","useDispatch","userLogin","personLogin","axiosInstance","useLogin","_s","error","setError","isLoading","setIsLoading","dispatch","login","formData","response","post","catch","console","log","data","status","headers","request","message","localStorage","setItem","defaults","getItem","response1","get","alert"],"sources":["/home/sahil/Student-Record-Management-System/frontend/src/hooks/useLogin.js"],"sourcesContent":["import { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userLogin} from '../Store/Slices/userSlice';\nimport { personLogin} from '../Store/Slices/personSlice';\nimport axiosInstance from \"../axios\";\nexport const useLogin=()=>{\n    const [error,setError]=useState(null);\n    const [isLoading,setIsLoading]=useState(null);\n    const dispatch=useDispatch();\n\n    const login=async (formData)=>{\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const response = await axiosInstance.post('Auth/login', formData).catch(function (error) {\n                console.log(response);\n                if (error.response) {\n                    // The request was made and the server responded with a status code\n                    // that falls out of the range of 2xx\n                    console.log(error.response.data);\n                    console.log(error.response.status);\n                    console.log(error.response.headers);\n                } else if (error.request) {\n                    // The request was made but no response was received\n                    // `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n                    // http.ClientRequest in node.js\n                    console.log(error.request);\n                } else {\n                    // Something happened in setting up the request that triggered an Error\n                    console.log('Error', error.message);\n                }\n                setError(true)\n\n            });// Replace 'Auth/login' with your desired login endpoint\n            console.log('Login response:', response.data['token']['access']);\n            localStorage.setItem('access_token',response.data['token']['access']);\n            localStorage.setItem('refresh_token', response.data['token']['refresh']);\n            axiosInstance.defaults.headers['Authorization'] = 'Bearer '+ localStorage.getItem('access_token');\n\n            // dispatch(userLogin(response.data));\n            const response1 = await axiosInstance.get('Auth/profile')\n            console.log(response1)\n            // console.log(response1.data)\n            dispatch(personLogin(response1.data));\n\n\n        } catch (error) {\n            alert(error)\n            setError(error);\n        }\n\n        setIsLoading(false);\n\n        //     if(!dataresponse.ok){\n        //         setIsLoading(false);\n        //\n        //     }\n        //     if(dataresponse.ok){\n        //     localStorage.setItem('user', JSON.stringify(json));\n\n        //     dispatch(userLogin(json));\n        //     dispatch(personLogin(datajson));\n        //     }\n        // }\n    }\n    return {login,isLoading,error};\n}"],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,SAAS,QAAO,2BAA2B;AACpD,SAASC,WAAW,QAAO,6BAA6B;AACxD,OAAOC,aAAa,MAAM,UAAU;AACpC,OAAO,MAAMC,QAAQ,GAACA,CAAA,KAAI;EAAAC,EAAA;EACtB,MAAM,CAACC,KAAK,EAACC,QAAQ,CAAC,GAACR,QAAQ,CAAC,IAAI,CAAC;EACrC,MAAM,CAACS,SAAS,EAACC,YAAY,CAAC,GAACV,QAAQ,CAAC,IAAI,CAAC;EAC7C,MAAMW,QAAQ,GAACV,WAAW,CAAC,CAAC;EAE5B,MAAMW,KAAK,GAAC,MAAOC,QAAQ,IAAG;IAC1BH,YAAY,CAAC,IAAI,CAAC;IAClBF,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACA,MAAMM,QAAQ,GAAG,MAAMV,aAAa,CAACW,IAAI,CAAC,YAAY,EAAEF,QAAQ,CAAC,CAACG,KAAK,CAAC,UAAUT,KAAK,EAAE;QACrFU,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAAC;QACrB,IAAIP,KAAK,CAACO,QAAQ,EAAE;UAChB;UACA;UACAG,OAAO,CAACC,GAAG,CAACX,KAAK,CAACO,QAAQ,CAACK,IAAI,CAAC;UAChCF,OAAO,CAACC,GAAG,CAACX,KAAK,CAACO,QAAQ,CAACM,MAAM,CAAC;UAClCH,OAAO,CAACC,GAAG,CAACX,KAAK,CAACO,QAAQ,CAACO,OAAO,CAAC;QACvC,CAAC,MAAM,IAAId,KAAK,CAACe,OAAO,EAAE;UACtB;UACA;UACA;UACAL,OAAO,CAACC,GAAG,CAACX,KAAK,CAACe,OAAO,CAAC;QAC9B,CAAC,MAAM;UACH;UACAL,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEX,KAAK,CAACgB,OAAO,CAAC;QACvC;QACAf,QAAQ,CAAC,IAAI,CAAC;MAElB,CAAC,CAAC,CAAC;MACHS,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEJ,QAAQ,CAACK,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC;MAChEK,YAAY,CAACC,OAAO,CAAC,cAAc,EAACX,QAAQ,CAACK,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC;MACrEK,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEX,QAAQ,CAACK,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC;MACxEf,aAAa,CAACsB,QAAQ,CAACL,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,GAAEG,YAAY,CAACG,OAAO,CAAC,cAAc,CAAC;;MAEjG;MACA,MAAMC,SAAS,GAAG,MAAMxB,aAAa,CAACyB,GAAG,CAAC,cAAc,CAAC;MACzDZ,OAAO,CAACC,GAAG,CAACU,SAAS,CAAC;MACtB;MACAjB,QAAQ,CAACR,WAAW,CAACyB,SAAS,CAACT,IAAI,CAAC,CAAC;IAGzC,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACZuB,KAAK,CAACvB,KAAK,CAAC;MACZC,QAAQ,CAACD,KAAK,CAAC;IACnB;IAEAG,YAAY,CAAC,KAAK,CAAC;;IAEnB;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;EACJ,CAAC;;EACD,OAAO;IAACE,KAAK;IAACH,SAAS;IAACF;EAAK,CAAC;AAClC,CAAC;AAAAD,EAAA,CA9DYD,QAAQ;EAAA,QAGFJ,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}