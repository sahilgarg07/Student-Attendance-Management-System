{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useLogin.js\nimport { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userLogin } from '../Store/Slices/userSlice';\nimport { personLogin } from '../Store/Slices/personSlice';\nimport axiosInstance from \"../axios\";\nexport const useLogin = () => {\n  _s();\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const dispatch = useDispatch();\n  const login = async formData => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await axiosInstance.post('Auth/login', formData);\n      const {\n        access,\n        refresh\n      } = response.data.token;\n      localStorage.setItem('access_token', access);\n      localStorage.setItem('refresh_token', refresh);\n      axiosInstance.defaults.headers['Authorization'] = `Bearer ${access}`;\n      dispatch(userLogin(response.data));\n      const profileResponse = await axiosInstance.get('Auth/profile');\n      dispatch(personLogin(profileResponse.data));\n      return true;\n    } catch (error) {\n      console.error('Login error:', error);\n      if (error.response) {\n        // The request was made and the server responded with a status code\n        // that falls out of the range of 2xx\n        setError(error.response.data.message || 'An error occurred during login');\n      } else if (error.request) {\n        // The request was made but no response was received\n        setError('No response received from server. Please try again.');\n      } else {\n        // Something happened in setting up the request that triggered an Error\n        setError('An unexpected error occurred. Please try again.');\n      }\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  return {\n    login,\n    isLoading,\n    error\n  };\n};\n_s(useLogin, \"AmFShE+0Mj8oS9+4hOzi1cyUCMg=\", false, function () {\n  return [useDispatch];\n});","map":{"version":3,"names":["useState","useDispatch","userLogin","personLogin","axiosInstance","useLogin","_s","error","setError","isLoading","setIsLoading","dispatch","login","formData","response","post","access","refresh","data","token","localStorage","setItem","defaults","headers","profileResponse","get","console","message","request"],"sources":["/home/sahil/Student-Record-Management-System/frontend/src/hooks/useLogin.js"],"sourcesContent":["// src/hooks/useLogin.js\nimport { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userLogin } from '../Store/Slices/userSlice';\nimport { personLogin } from '../Store/Slices/personSlice';\nimport axiosInstance from \"../axios\";\n\nexport const useLogin = () => {\n    const [error, setError] = useState(null);\n    const [isLoading, setIsLoading] = useState(false);\n    const dispatch = useDispatch();\n\n    const login = async (formData) => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const response = await axiosInstance.post('Auth/login', formData);\n            \n            const { access, refresh } = response.data.token;\n            \n            localStorage.setItem('access_token', access);\n            localStorage.setItem('refresh_token', refresh);\n            \n            axiosInstance.defaults.headers['Authorization'] = `Bearer ${access}`;\n\n            dispatch(userLogin(response.data));\n\n            const profileResponse = await axiosInstance.get('Auth/profile');\n            dispatch(personLogin(profileResponse.data));\n\n            return true;\n        } catch (error) {\n            console.error('Login error:', error);\n            if (error.response) {\n                // The request was made and the server responded with a status code\n                // that falls out of the range of 2xx\n                setError(error.response.data.message || 'An error occurred during login');\n            } else if (error.request) {\n                // The request was made but no response was received\n                setError('No response received from server. Please try again.');\n            } else {\n                // Something happened in setting up the request that triggered an Error\n                setError('An unexpected error occurred. Please try again.');\n            }\n            return false;\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    return { login, isLoading, error };\n};"],"mappings":";AAAA;AACA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,SAAS,QAAQ,2BAA2B;AACrD,SAASC,WAAW,QAAQ,6BAA6B;AACzD,OAAOC,aAAa,MAAM,UAAU;AAEpC,OAAO,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC1B,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACS,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAMW,QAAQ,GAAGV,WAAW,CAAC,CAAC;EAE9B,MAAMW,KAAK,GAAG,MAAOC,QAAQ,IAAK;IAC9BH,YAAY,CAAC,IAAI,CAAC;IAClBF,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACA,MAAMM,QAAQ,GAAG,MAAMV,aAAa,CAACW,IAAI,CAAC,YAAY,EAAEF,QAAQ,CAAC;MAEjE,MAAM;QAAEG,MAAM;QAAEC;MAAQ,CAAC,GAAGH,QAAQ,CAACI,IAAI,CAACC,KAAK;MAE/CC,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEL,MAAM,CAAC;MAC5CI,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEJ,OAAO,CAAC;MAE9Cb,aAAa,CAACkB,QAAQ,CAACC,OAAO,CAAC,eAAe,CAAC,GAAI,UAASP,MAAO,EAAC;MAEpEL,QAAQ,CAACT,SAAS,CAACY,QAAQ,CAACI,IAAI,CAAC,CAAC;MAElC,MAAMM,eAAe,GAAG,MAAMpB,aAAa,CAACqB,GAAG,CAAC,cAAc,CAAC;MAC/Dd,QAAQ,CAACR,WAAW,CAACqB,eAAe,CAACN,IAAI,CAAC,CAAC;MAE3C,OAAO,IAAI;IACf,CAAC,CAAC,OAAOX,KAAK,EAAE;MACZmB,OAAO,CAACnB,KAAK,CAAC,cAAc,EAAEA,KAAK,CAAC;MACpC,IAAIA,KAAK,CAACO,QAAQ,EAAE;QAChB;QACA;QACAN,QAAQ,CAACD,KAAK,CAACO,QAAQ,CAACI,IAAI,CAACS,OAAO,IAAI,gCAAgC,CAAC;MAC7E,CAAC,MAAM,IAAIpB,KAAK,CAACqB,OAAO,EAAE;QACtB;QACApB,QAAQ,CAAC,qDAAqD,CAAC;MACnE,CAAC,MAAM;QACH;QACAA,QAAQ,CAAC,iDAAiD,CAAC;MAC/D;MACA,OAAO,KAAK;IAChB,CAAC,SAAS;MACNE,YAAY,CAAC,KAAK,CAAC;IACvB;EACJ,CAAC;EAED,OAAO;IAAEE,KAAK;IAAEH,SAAS;IAAEF;EAAM,CAAC;AACtC,CAAC;AAACD,EAAA,CA7CWD,QAAQ;EAAA,QAGAJ,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}