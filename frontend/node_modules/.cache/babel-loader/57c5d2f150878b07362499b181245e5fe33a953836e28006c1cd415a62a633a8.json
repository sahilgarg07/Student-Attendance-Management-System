{"ast":null,"code":"import axios from 'axios';\nconst baseURL = 'http://127.0.0.1:8000/api/';\nconst axiosInstance = axios.create({\n  baseURL: baseURL,\n  timeout: 5000,\n  headers: {\n    Authorization: localStorage.getItem('access_token') ? 'Bearer ' + localStorage.getItem('access_token') : null,\n    'Content-Type': 'application/json',\n    accept: 'application/json'\n  }\n});\naxiosInstance.interceptors.response.use(response => response, async error => {\n  const originalRequest = error.config;\n  if (error.response.status === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    const refreshToken = localStorage.getItem('refresh_token');\n    try {\n      const response = await axios.post(`${baseURL}Auth/token/refresh/`, {\n        refresh: refreshToken\n      });\n      if (response.status === 200) {\n        localStorage.setItem('access_token', response.data.access);\n        axiosInstance.defaults.headers['Authorization'] = 'Bearer ' + response.data.access;\n        originalRequest.headers['Authorization'] = 'Bearer ' + response.data.access;\n        return axiosInstance(originalRequest);\n      }\n    } catch (refreshError) {\n      console.error('Error refreshing token:', refreshError);\n      // Logout user if refresh fails\n      localStorage.removeItem('access_token');\n      localStorage.removeItem('refresh_token');\n      window.location.href = '/login';\n    }\n  }\n  return Promise.reject(error);\n});\nexport default axiosInstance;","map":{"version":3,"names":["axios","baseURL","axiosInstance","create","timeout","headers","Authorization","localStorage","getItem","accept","interceptors","response","use","error","originalRequest","config","status","_retry","refreshToken","post","refresh","setItem","data","access","defaults","refreshError","console","removeItem","window","location","href","Promise","reject"],"sources":["/home/sahil/Student-Record-Management-System/frontend/src/axios.jsx"],"sourcesContent":["import axios from 'axios';\n\nconst baseURL = 'http://127.0.0.1:8000/api/';\n\nconst axiosInstance = axios.create({\n    baseURL: baseURL,\n    timeout: 5000,\n    headers: {\n        Authorization: localStorage.getItem('access_token')\n            ? 'Bearer ' + localStorage.getItem('access_token')\n            : null,\n        'Content-Type': 'application/json',\n        accept: 'application/json',\n    },\n});\n\naxiosInstance.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n        const originalRequest = error.config;\n\n        if (error.response.status === 401 && !originalRequest._retry) {\n            originalRequest._retry = true;\n            const refreshToken = localStorage.getItem('refresh_token');\n\n            try {\n                const response = await axios.post(`${baseURL}Auth/token/refresh/`, {\n                    refresh: refreshToken\n                });\n\n                if (response.status === 200) {\n                    localStorage.setItem('access_token', response.data.access);\n                    axiosInstance.defaults.headers['Authorization'] = 'Bearer ' + response.data.access;\n                    originalRequest.headers['Authorization'] = 'Bearer ' + response.data.access;\n                    return axiosInstance(originalRequest);\n                }\n            } catch (refreshError) {\n                console.error('Error refreshing token:', refreshError);\n                // Logout user if refresh fails\n                localStorage.removeItem('access_token');\n                localStorage.removeItem('refresh_token');\n                window.location.href = '/login';\n            }\n        }\n\n        return Promise.reject(error);\n    }\n);\n\nexport default axiosInstance;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAG,4BAA4B;AAE5C,MAAMC,aAAa,GAAGF,KAAK,CAACG,MAAM,CAAC;EAC/BF,OAAO,EAAEA,OAAO;EAChBG,OAAO,EAAE,IAAI;EACbC,OAAO,EAAE;IACLC,aAAa,EAAEC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,GAC7C,SAAS,GAAGD,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,GAChD,IAAI;IACV,cAAc,EAAE,kBAAkB;IAClCC,MAAM,EAAE;EACZ;AACJ,CAAC,CAAC;AAEFP,aAAa,CAACQ,YAAY,CAACC,QAAQ,CAACC,GAAG,CAClCD,QAAQ,IAAKA,QAAQ,EACtB,MAAOE,KAAK,IAAK;EACb,MAAMC,eAAe,GAAGD,KAAK,CAACE,MAAM;EAEpC,IAAIF,KAAK,CAACF,QAAQ,CAACK,MAAM,KAAK,GAAG,IAAI,CAACF,eAAe,CAACG,MAAM,EAAE;IAC1DH,eAAe,CAACG,MAAM,GAAG,IAAI;IAC7B,MAAMC,YAAY,GAAGX,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;IAE1D,IAAI;MACA,MAAMG,QAAQ,GAAG,MAAMX,KAAK,CAACmB,IAAI,CAAE,GAAElB,OAAQ,qBAAoB,EAAE;QAC/DmB,OAAO,EAAEF;MACb,CAAC,CAAC;MAEF,IAAIP,QAAQ,CAACK,MAAM,KAAK,GAAG,EAAE;QACzBT,YAAY,CAACc,OAAO,CAAC,cAAc,EAAEV,QAAQ,CAACW,IAAI,CAACC,MAAM,CAAC;QAC1DrB,aAAa,CAACsB,QAAQ,CAACnB,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,GAAGM,QAAQ,CAACW,IAAI,CAACC,MAAM;QAClFT,eAAe,CAACT,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,GAAGM,QAAQ,CAACW,IAAI,CAACC,MAAM;QAC3E,OAAOrB,aAAa,CAACY,eAAe,CAAC;MACzC;IACJ,CAAC,CAAC,OAAOW,YAAY,EAAE;MACnBC,OAAO,CAACb,KAAK,CAAC,yBAAyB,EAAEY,YAAY,CAAC;MACtD;MACAlB,YAAY,CAACoB,UAAU,CAAC,cAAc,CAAC;MACvCpB,YAAY,CAACoB,UAAU,CAAC,eAAe,CAAC;MACxCC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;IACnC;EACJ;EAEA,OAAOC,OAAO,CAACC,MAAM,CAACnB,KAAK,CAAC;AAChC,CACJ,CAAC;AAED,eAAeX,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}